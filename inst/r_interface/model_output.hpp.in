{{header}}

#pragma once

#include <Rcpp.h>
#include <unsupported/Eigen/CXX11/Tensor>

#include "state_saver.hpp"

template<typename real_type, leapfrog::HivAgeStratification S>
Rcpp::List build_r_output(const typename leapfrog::StateSaver<real_type, S>::OutputState &state,
                          const std::vector<int> save_steps) {
  constexpr auto ss = leapfrog::StateSpace<S>();
  size_t output_years = save_steps.size();
  {{initialise_r_memory}}

  {{set_r_dimensions}}

  {{copy_data}}

  {{return_output}}
}
