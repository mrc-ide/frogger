// Generated by frogger: do not edit by hand
// This file is automatically generated. Do not edit this file. If you want to make changes
// edit `state_types.hpp.in` and run `./scripts/generate` to regenerate.

#pragma once

#include <type_traits>

#include "../intermediate_data.hpp"
#include "../parameters.hpp"
#include "../state_space.hpp"
#include "../model_variants.hpp"

namespace leapfrog {

namespace {
using Eigen::Sizes;
using Eigen::TensorFixedSize;
}

template<typename ModelVariant, typename real_type>
struct PaediatricModelState {
  PaediatricModelState(const Parameters<ModelVariant, real_type> &pars) {}

  void reset() {}
};

template<typename ModelVariant, typename real_type>
struct DemographicProjectionState {
  TensorFixedSize<real_type, Sizes<pAG<ModelVariant>, NS<ModelVariant>>> p_total_pop;
  real_type births;
  TensorFixedSize<real_type, Sizes<pAG<ModelVariant>, NS<ModelVariant>>> p_total_pop_natural_deaths;

  DemographicProjectionState(const Parameters<ModelVariant, real_type> &pars) {
    reset();
  }

  void reset() {
    p_total_pop.setZero();
    births = 0;
    p_total_pop_natural_deaths.setZero();
  }
};

template<typename ModelVariant, typename real_type, typename Enable = void>
struct HivSimulationState {
  HivSimulationState(const Parameters<ModelVariant, real_type> &pars) {}

  void reset() {}
};

template<typename ModelVariant, typename real_type>
struct HivSimulationState<ModelVariant, real_type,
    std::enable_if_t<ModelVariant::run_hiv_simulation>> {
  TensorFixedSize<real_type, Sizes<pAG<ModelVariant>, NS<ModelVariant>>> p_hiv_pop;
  TensorFixedSize<real_type, Sizes<pAG<ModelVariant>, NS<ModelVariant>>> p_hiv_pop_natural_deaths;
  TensorFixedSize<real_type, Sizes<hDS<ModelVariant>, hAG<ModelVariant>, NS<ModelVariant>>> h_hiv_adult;
  TensorFixedSize<real_type, Sizes<hTS<ModelVariant>, hDS<ModelVariant>, hAG<ModelVariant>, NS<ModelVariant>>> h_art_adult;
  TensorFixedSize<real_type, Sizes<hDS<ModelVariant>, hAG<ModelVariant>, NS<ModelVariant>>> h_hiv_deaths_no_art;
  TensorFixedSize<real_type, Sizes<pAG<ModelVariant>, NS<ModelVariant>>> p_infections;
  TensorFixedSize<real_type, Sizes<hTS<ModelVariant>, hDS<ModelVariant>, hAG<ModelVariant>, NS<ModelVariant>>> h_hiv_deaths_art;
  TensorFixedSize<real_type, Sizes<hDS<ModelVariant>, hAG<ModelVariant>, NS<ModelVariant>>> h_art_initiation;
  TensorFixedSize<real_type, Sizes<pAG<ModelVariant>, NS<ModelVariant>>> p_hiv_deaths;

  HivSimulationState(const Parameters<ModelVariant, real_type> &pars) {
    reset();
  }

  void reset() {
    p_hiv_pop.setZero();
    p_hiv_pop_natural_deaths.setZero();
    h_hiv_adult.setZero();
    h_art_adult.setZero();
    h_hiv_deaths_no_art.setZero();
    p_infections.setZero();
    h_hiv_deaths_art.setZero();
    h_art_initiation.setZero();
    p_hiv_deaths.setZero();
  }
};

template<typename real_type>
struct PaediatricModelState<PaediatricModel, real_type> {
  TensorFixedSize<real_type, Sizes<hc1DS<PaediatricModel>, hcTT<PaediatricModel>, hc1AG<PaediatricModel>, NS<PaediatricModel>>> hc1_hiv_pop;
  TensorFixedSize<real_type, Sizes<hc2DS<PaediatricModel>, hcTT<PaediatricModel>, hc2AG<PaediatricModel>, NS<PaediatricModel>>> hc2_hiv_pop;
  TensorFixedSize<real_type, Sizes<hTS<PaediatricModel>, hc1DS<PaediatricModel>, hc1AG<PaediatricModel>, NS<PaediatricModel>>> hc1_art_pop;
  TensorFixedSize<real_type, Sizes<hTS<PaediatricModel>, hc2DS<PaediatricModel>, hc2AG<PaediatricModel>, NS<PaediatricModel>>> hc2_art_pop;
  TensorFixedSize<real_type, Sizes<hc1DS<PaediatricModel>, hcTT<PaediatricModel>, hc1AG<PaediatricModel>, NS<PaediatricModel>>> hc1_noart_aids_deaths;
  TensorFixedSize<real_type, Sizes<hc2DS<PaediatricModel>, hcTT<PaediatricModel>, hc2AG<PaediatricModel>, NS<PaediatricModel>>> hc2_noart_aids_deaths;
  TensorFixedSize<real_type, Sizes<hTS<PaediatricModel>, hc1DS<PaediatricModel>, hc1AG<PaediatricModel>, NS<PaediatricModel>>> hc1_art_aids_deaths;
  TensorFixedSize<real_type, Sizes<hTS<PaediatricModel>, hc2DS<PaediatricModel>, hc2AG<PaediatricModel>, NS<PaediatricModel>>> hc2_art_aids_deaths;
  real_type hiv_births;
  TensorFixedSize<real_type, Sizes<hcAG_coarse<PaediatricModel>>> hc_art_init;
  TensorFixedSize<real_type, Sizes<hc1DS<PaediatricModel>, hcTT<PaediatricModel>, hcAG_end<PaediatricModel>, NS<PaediatricModel>>> hc_art_need_init;
  real_type ctx_need;
  real_type ctx_mean;

  PaediatricModelState(const Parameters<PaediatricModel, real_type> &pars) {
    reset();
  }

  void reset() {
    hc1_hiv_pop.setZero();
    hc2_hiv_pop.setZero();
    hc1_art_pop.setZero();
    hc2_art_pop.setZero();
    hc1_noart_aids_deaths.setZero();
    hc2_noart_aids_deaths.setZero();
    hc1_art_aids_deaths.setZero();
    hc2_art_aids_deaths.setZero();
    hiv_births = 0;
    hc_art_init.setZero();
    hc_art_need_init.setZero();
    ctx_need = 0;
    ctx_mean = 0;
  }
};

template<typename ModelVariant, typename real_type>
struct State {
  DemographicProjectionState<ModelVariant, real_type> dp;
  HivSimulationState<ModelVariant, real_type> hiv;
  PaediatricModelState<ModelVariant, real_type> children;

  State(const Parameters<ModelVariant, real_type> &pars) :
      dp(pars),
      hiv(pars),
      children(pars) {}

  void reset() {
    dp.reset();
    hiv.reset();
    children.reset();
  }
};

}
